import os
import yaml

# load configuration files
configfile: "config/config.yaml"

PROJECT = config["project"]
configfile: f"config/projects/{PROJECT}.yaml"

# set up paths
ENV = config.get("environment", "local") 
INDIR = config['environments'][ENV]['era5dir']
WD = config['environments'][ENV]['datadir']
PROJDIR = os.path.join(WD, config['project'])
PROCESSING_DIR = os.path.join(PROJDIR, "processing")
RESOURCES_DIR = config["resources"]

for directory in [PROJDIR, PROCESSING_DIR]:
    os.makedirs(directory, exist_ok=True)

# set up conda environments
CONDA = config['environments'][ENV]['environment']
RENV  = config['renv']

# set up project parameters
YEARS = list(range(config["year0"], config["yearn"]))
FIELDS = config["fields"]
RESOLUTION = config["resolution"]
LONGITUDE = config["longitude"]
LATITUDE  = config["latitude"]
RFUNC     = config["rfunc"]
SFUNC     = config["sfunc"]

# load rules
include: "rules/get_data.smk"
include: "rules/process_data.smk"

